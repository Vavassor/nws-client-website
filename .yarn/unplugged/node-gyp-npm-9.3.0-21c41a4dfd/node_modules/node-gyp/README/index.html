<div class="heading-and-link">
<h1 id="node-gyp---node.js-native-addon-build-tool" tabindex="-1"><code>node-gyp</code> - Node.js native addon build tool</h1>
<a class="header-anchor" href="#node-gyp---node.js-native-addon-build-tool"><span class="visually-hidden">Permalink to “node-gyp - Node.js native addon build tool”</span> <span aria-hidden="true">#</span></a></div>
<p><a href="https://github.com/nodejs/node-gyp/actions?query=workflow%3ATests+branch%3Amaster"><img src="https://github.com/nodejs/node-gyp/workflows/Tests/badge.svg?branch=master" alt="Build Status"></a><br>
<img src="https://img.shields.io/npm/dm/node-gyp" alt="npm"></p>
<p><code>node-gyp</code> is a cross-platform command-line tool written in Node.js for<br>
compiling native addon modules for Node.js. It contains a vendored copy of the<br>
<a href="https://github.com/nodejs/gyp-next">gyp-next</a> project that was previously used<br>
by the Chromium team, extended to support the development of Node.js native addons.</p>
<p>Note that <code>node-gyp</code> is <em>not</em> used to build Node.js itself.</p>
<p>Multiple target versions of Node.js are supported (i.e. <code>0.8</code>, ..., <code>4</code>, <code>5</code>, <code>6</code>,<br>
etc.), regardless of what version of Node.js is actually installed on your system<br>
(<code>node-gyp</code> downloads the necessary development files or headers for the target version).</p>
<div class="heading-and-link">
<h2 id="features" tabindex="-1">Features</h2>
<a class="header-anchor" href="#features"><span class="visually-hidden">Permalink to “Features”</span> <span aria-hidden="true">#</span></a></div>
<ul>
<li>The same build commands work on any of the supported platforms</li>
<li>Supports the targeting of different versions of Node.js</li>
</ul>
<div class="heading-and-link">
<h2 id="installation" tabindex="-1">Installation</h2>
<a class="header-anchor" href="#installation"><span class="visually-hidden">Permalink to “Installation”</span> <span aria-hidden="true">#</span></a></div>
<p>You can install <code>node-gyp</code> using <code>npm</code>:</p>
<pre><code class="language-bash">npm install -g node-gyp
</code></pre>
<p>Depending on your operating system, you will need to install:</p>
<div class="heading-and-link">
<h3 id="on-unix" tabindex="-1">On Unix</h3>
<a class="header-anchor" href="#on-unix"><span class="visually-hidden">Permalink to “On Unix”</span> <span aria-hidden="true">#</span></a></div>
<ul>
<li>Python v3.7, v3.8, v3.9, or v3.10</li>
<li><code>make</code></li>
<li>A proper C/C++ compiler toolchain, like <a href="https://gcc.gnu.org">GCC</a></li>
</ul>
<div class="heading-and-link">
<h3 id="on-macos" tabindex="-1">On macOS</h3>
<a class="header-anchor" href="#on-macos"><span class="visually-hidden">Permalink to “On macOS”</span> <span aria-hidden="true">#</span></a></div>
<p><strong>ATTENTION</strong>: If your Mac has been <em>upgraded</em> to macOS Catalina (10.15) or higher, please read <a href="macOS_Catalina.md">macOS_Catalina.md</a>.</p>
<ul>
<li>Python v3.7, v3.8, v3.9, or v3.10</li>
<li><code>XCode Command Line Tools</code> which will install <code>clang</code>, <code>clang++</code>, and <code>make</code>.
<ul>
<li>Install the <code>XCode Command Line Tools</code> standalone by running <code>xcode-select --install</code>. -- OR --</li>
<li>Alternatively, if you already have the <a href="https://developer.apple.com/xcode/download/">full Xcode installed</a>, you can install the Command Line Tools under the menu <code>Xcode -&gt; Open Developer Tool -&gt; More Developer Tools...</code>.</li>
</ul>
</li>
</ul>
<div class="heading-and-link">
<h3 id="on-windows" tabindex="-1">On Windows</h3>
<a class="header-anchor" href="#on-windows"><span class="visually-hidden">Permalink to “On Windows”</span> <span aria-hidden="true">#</span></a></div>
<p>Install the current version of Python from the <a href="https://www.microsoft.com/en-us/p/python-310/9pjpw5ldxlz5">Microsoft Store package</a>.</p>
<p>Install tools and configuration manually:</p>
<ul>
<li>Install Visual C++ Build Environment: <a href="https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=BuildTools">Visual Studio Build Tools</a><br>
(using &quot;Visual C++ build tools&quot; workload) or <a href="https://visualstudio.microsoft.com/thank-you-downloading-visual-studio/?sku=Community">Visual Studio Community</a><br>
(using the &quot;Desktop development with C++&quot; workload)</li>
<li>Launch cmd, <code>npm config set msvs_version 2017</code></li>
</ul>
<p>If the above steps didn't work for you, please visit <a href="https://github.com/Microsoft/nodejs-guidelines/blob/master/windows-environment.md#compiling-native-addon-modules">Microsoft's Node.js Guidelines for Windows</a> for additional tips.</p>
<p>To target native ARM64 Node.js on Windows 10 on ARM, add the components &quot;Visual C++ compilers and libraries for ARM64&quot; and &quot;Visual C++ ATL for ARM64&quot;.</p>
<div class="heading-and-link">
<h3 id="configuring-python-dependency" tabindex="-1">Configuring Python Dependency</h3>
<a class="header-anchor" href="#configuring-python-dependency"><span class="visually-hidden">Permalink to “Configuring Python Dependency”</span> <span aria-hidden="true">#</span></a></div>
<p><code>node-gyp</code> requires that you have installed a compatible version of Python, one of: v3.7, v3.8,<br>
v3.9, or v3.10. If you have multiple Python versions installed, you can identify which Python<br>
version <code>node-gyp</code> should use in one of the following ways:</p>
<ol>
<li>by setting the <code>--python</code> command-line option, e.g.:</li>
</ol>
<pre><code class="language-bash">node-gyp &lt;command&gt; --python /path/to/executable/python
</code></pre>
<ol start="2">
<li>If <code>node-gyp</code> is called by way of <code>npm</code>, <em>and</em> you have multiple versions of<br>
Python installed, then you can set <code>npm</code>'s 'python' config key to the appropriate<br>
value:</li>
</ol>
<pre><code class="language-bash">npm config set python /path/to/executable/python
</code></pre>
<ol start="3">
<li>
<p>If the <code>PYTHON</code> environment variable is set to the path of a Python executable,<br>
then that version will be used, if it is a compatible version.</p>
</li>
<li>
<p>If the <code>NODE_GYP_FORCE_PYTHON</code> environment variable is set to the path of a<br>
Python executable, it will be used instead of any of the other configured or<br>
builtin Python search paths. If it's not a compatible version, no further<br>
searching will be done.</p>
</li>
</ol>
<div class="heading-and-link">
<h3 id="build-for-third-party-node.js-runtimes" tabindex="-1">Build for Third Party Node.js Runtimes</h3>
<a class="header-anchor" href="#build-for-third-party-node.js-runtimes"><span class="visually-hidden">Permalink to “Build for Third Party Node.js Runtimes”</span> <span aria-hidden="true">#</span></a></div>
<p>When building modules for third party Node.js runtimes like Electron, which have<br>
different build configurations from the official Node.js distribution, you<br>
should use <code>--dist-url</code> or <code>--nodedir</code> flags to specify the headers of the<br>
runtime to build for.</p>
<p>Also when <code>--dist-url</code> or <code>--nodedir</code> flags are passed, node-gyp will use the<br>
<code>config.gypi</code> shipped in the headers distribution to generate build<br>
configurations, which is different from the default mode that would use the<br>
<code>process.config</code> object of the running Node.js instance.</p>
<p>Some old versions of Electron shipped malformed <code>config.gypi</code> in their headers<br>
distributions, and you might need to pass <code>--force-process-config</code> to node-gyp<br>
to work around configuration errors.</p>
<div class="heading-and-link">
<h2 id="how-to-use" tabindex="-1">How to Use</h2>
<a class="header-anchor" href="#how-to-use"><span class="visually-hidden">Permalink to “How to Use”</span> <span aria-hidden="true">#</span></a></div>
<p>To compile your native addon, first go to its root directory:</p>
<pre><code class="language-bash">cd my_node_addon
</code></pre>
<p>The next step is to generate the appropriate project build files for the current<br>
platform. Use <code>configure</code> for that:</p>
<pre><code class="language-bash">node-gyp configure
</code></pre>
<p>Auto-detection fails for Visual C++ Build Tools 2015, so <code>--msvs_version=2015</code><br>
needs to be added (not needed when run by npm as configured above):</p>
<pre><code class="language-bash">node-gyp configure --msvs_version=2015
</code></pre>
<p><strong>Note</strong>: The <code>configure</code> step looks for a <code>binding.gyp</code> file in the current<br>
directory to process. See below for instructions on creating a <code>binding.gyp</code> file.</p>
<p>Now you will have either a <code>Makefile</code> (on Unix platforms) or a <code>vcxproj</code> file<br>
(on Windows) in the <code>build/</code> directory. Next, invoke the <code>build</code> command:</p>
<pre><code class="language-bash">node-gyp build
</code></pre>
<p>Now you have your compiled <code>.node</code> bindings file! The compiled bindings end up<br>
in <code>build/Debug/</code> or <code>build/Release/</code>, depending on the build mode. At this point,<br>
you can require the <code>.node</code> file with Node.js and run your tests!</p>
<p><strong>Note:</strong> To create a <em>Debug</em> build of the bindings file, pass the <code>--debug</code> (or<br>
<code>-d</code>) switch when running either the <code>configure</code>, <code>build</code> or <code>rebuild</code> commands.</p>
<div class="heading-and-link">
<h2 id="the-binding.gyp-file" tabindex="-1">The <code>binding.gyp</code> file</h2>
<a class="header-anchor" href="#the-binding.gyp-file"><span class="visually-hidden">Permalink to “The binding.gyp file”</span> <span aria-hidden="true">#</span></a></div>
<p>A <code>binding.gyp</code> file describes the configuration to build your module, in a<br>
JSON-like format. This file gets placed in the root of your package, alongside<br>
<code>package.json</code>.</p>
<p>A barebones <code>gyp</code> file appropriate for building a Node.js addon could look like:</p>
<pre><code class="language-python">{
  &quot;targets&quot;: [
    {
      &quot;target_name&quot;: &quot;binding&quot;,
      &quot;sources&quot;: [ &quot;src/binding.cc&quot; ]
    }
  ]
}
</code></pre>
<div class="heading-and-link">
<h2 id="further-reading" tabindex="-1">Further reading</h2>
<a class="header-anchor" href="#further-reading"><span class="visually-hidden">Permalink to “Further reading”</span> <span aria-hidden="true">#</span></a></div>
<p>The <strong><a href="./docs/">docs</a></strong> directory contains additional documentation on specific node-gyp topics that may be useful if you are experiencing problems installing or building addons using node-gyp.</p>
<p>Some additional resources for Node.js native addons and writing <code>gyp</code> configuration files:</p>
<ul>
<li><a href="http://nodeschool.io/#goingnative">&quot;Going Native&quot; a nodeschool.io tutorial</a></li>
<li><a href="https://github.com/nodejs/node/tree/master/test/addons/hello-world">&quot;Hello World&quot; node addon example</a></li>
<li><a href="https://gyp.gsrc.io/docs/UserDocumentation.md">gyp user documentation</a></li>
<li><a href="https://gyp.gsrc.io/docs/InputFormatReference.md">gyp input format reference</a></li>
<li><a href="./docs/binding.gyp-files-in-the-wild.md"><em>&quot;binding.gyp&quot; files out in the wild</em> wiki page</a></li>
</ul>
<div class="heading-and-link">
<h2 id="commands" tabindex="-1">Commands</h2>
<a class="header-anchor" href="#commands"><span class="visually-hidden">Permalink to “Commands”</span> <span aria-hidden="true">#</span></a></div>
<p><code>node-gyp</code> responds to the following commands:</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Command</strong></th>
<th style="text-align:left"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>help</code></td>
<td style="text-align:left">Shows the help dialog</td>
</tr>
<tr>
<td style="text-align:left"><code>build</code></td>
<td style="text-align:left">Invokes <code>make</code>/<code>msbuild.exe</code> and builds the native addon</td>
</tr>
<tr>
<td style="text-align:left"><code>clean</code></td>
<td style="text-align:left">Removes the <code>build</code> directory if it exists</td>
</tr>
<tr>
<td style="text-align:left"><code>configure</code></td>
<td style="text-align:left">Generates project build files for the current platform</td>
</tr>
<tr>
<td style="text-align:left"><code>rebuild</code></td>
<td style="text-align:left">Runs <code>clean</code>, <code>configure</code> and <code>build</code> all in a row</td>
</tr>
<tr>
<td style="text-align:left"><code>install</code></td>
<td style="text-align:left">Installs Node.js header files for the given version</td>
</tr>
<tr>
<td style="text-align:left"><code>list</code></td>
<td style="text-align:left">Lists the currently installed Node.js header versions</td>
</tr>
<tr>
<td style="text-align:left"><code>remove</code></td>
<td style="text-align:left">Removes the Node.js header files for the given version</td>
</tr>
</tbody>
</table>
<div class="heading-and-link">
<h2 id="command-options" tabindex="-1">Command Options</h2>
<a class="header-anchor" href="#command-options"><span class="visually-hidden">Permalink to “Command Options”</span> <span aria-hidden="true">#</span></a></div>
<p><code>node-gyp</code> accepts the following command options:</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>Command</strong></th>
<th style="text-align:left"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-j n</code>, <code>--jobs n</code></td>
<td style="text-align:left">Run <code>make</code> in parallel. The value <code>max</code> will use all available CPU cores</td>
</tr>
<tr>
<td style="text-align:left"><code>--target=v6.2.1</code></td>
<td style="text-align:left">Node.js version to build for (default is <code>process.version</code>)</td>
</tr>
<tr>
<td style="text-align:left"><code>--silly</code>, <code>--loglevel=silly</code></td>
<td style="text-align:left">Log all progress to console</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code>, <code>--loglevel=verbose</code></td>
<td style="text-align:left">Log most progress to console</td>
</tr>
<tr>
<td style="text-align:left"><code>--silent</code>, <code>--loglevel=silent</code></td>
<td style="text-align:left">Don't log anything to console</td>
</tr>
<tr>
<td style="text-align:left"><code>debug</code>, <code>--debug</code></td>
<td style="text-align:left">Make Debug build (default is <code>Release</code>)</td>
</tr>
<tr>
<td style="text-align:left"><code>--release</code>, <code>--no-debug</code></td>
<td style="text-align:left">Make Release build</td>
</tr>
<tr>
<td style="text-align:left"><code>-C $dir</code>, <code>--directory=$dir</code></td>
<td style="text-align:left">Run command in different directory</td>
</tr>
<tr>
<td style="text-align:left"><code>--make=$make</code></td>
<td style="text-align:left">Override <code>make</code> command (e.g. <code>gmake</code>)</td>
</tr>
<tr>
<td style="text-align:left"><code>--thin=yes</code></td>
<td style="text-align:left">Enable thin static libraries</td>
</tr>
<tr>
<td style="text-align:left"><code>--arch=$arch</code></td>
<td style="text-align:left">Set target architecture (e.g. ia32)</td>
</tr>
<tr>
<td style="text-align:left"><code>--tarball=$path</code></td>
<td style="text-align:left">Get headers from a local tarball</td>
</tr>
<tr>
<td style="text-align:left"><code>--devdir=$path</code></td>
<td style="text-align:left">SDK download directory (default is OS cache directory)</td>
</tr>
<tr>
<td style="text-align:left"><code>--ensure</code></td>
<td style="text-align:left">Don't reinstall headers if already present</td>
</tr>
<tr>
<td style="text-align:left"><code>--dist-url=$url</code></td>
<td style="text-align:left">Download header tarball from custom URL</td>
</tr>
<tr>
<td style="text-align:left"><code>--proxy=$url</code></td>
<td style="text-align:left">Set HTTP(S) proxy for downloading header tarball</td>
</tr>
<tr>
<td style="text-align:left"><code>--noproxy=$urls</code></td>
<td style="text-align:left">Set urls to ignore proxies when downloading header tarball</td>
</tr>
<tr>
<td style="text-align:left"><code>--cafile=$cafile</code></td>
<td style="text-align:left">Override default CA chain (to download tarball)</td>
</tr>
<tr>
<td style="text-align:left"><code>--nodedir=$path</code></td>
<td style="text-align:left">Set the path to the node source code</td>
</tr>
<tr>
<td style="text-align:left"><code>--python=$path</code></td>
<td style="text-align:left">Set path to the Python binary</td>
</tr>
<tr>
<td style="text-align:left"><code>--msvs_version=$version</code></td>
<td style="text-align:left">Set Visual Studio version (Windows only)</td>
</tr>
<tr>
<td style="text-align:left"><code>--solution=$solution</code></td>
<td style="text-align:left">Set Visual Studio Solution version (Windows only)</td>
</tr>
<tr>
<td style="text-align:left"><code>--force-process-config</code></td>
<td style="text-align:left">Force using runtime's <code>process.config</code> object to generate <code>config.gypi</code> file</td>
</tr>
</tbody>
</table>
<div class="heading-and-link">
<h2 id="configuration" tabindex="-1">Configuration</h2>
<a class="header-anchor" href="#configuration"><span class="visually-hidden">Permalink to “Configuration”</span> <span aria-hidden="true">#</span></a></div>
<div class="heading-and-link">
<h3 id="environment-variables" tabindex="-1">Environment variables</h3>
<a class="header-anchor" href="#environment-variables"><span class="visually-hidden">Permalink to “Environment variables”</span> <span aria-hidden="true">#</span></a></div>
<p>Use the form <code>npm_config_OPTION_NAME</code> for any of the command options listed<br>
above (dashes in option names should be replaced by underscores).</p>
<p>For example, to set <code>devdir</code> equal to <code>/tmp/.gyp</code>, you would:</p>
<p>Run this on Unix:</p>
<pre><code class="language-bash">export npm_config_devdir=/tmp/.gyp
</code></pre>
<p>Or this on Windows:</p>
<pre><code class="language-console">set npm_config_devdir=c:\temp\.gyp
</code></pre>
<div class="heading-and-link">
<h3 id="npm-configuration" tabindex="-1"><code>npm</code> configuration</h3>
<a class="header-anchor" href="#npm-configuration"><span class="visually-hidden">Permalink to “npm configuration”</span> <span aria-hidden="true">#</span></a></div>
<p>Use the form <code>OPTION_NAME</code> for any of the command options listed above.</p>
<p>For example, to set <code>devdir</code> equal to <code>/tmp/.gyp</code>, you would run:</p>
<pre><code class="language-bash">npm config set [--global] devdir /tmp/.gyp
</code></pre>
<p><strong>Note:</strong> Configuration set via <code>npm</code> will only be used when <code>node-gyp</code><br>
is run via <code>npm</code>, not when <code>node-gyp</code> is run directly.</p>
<div class="heading-and-link">
<h2 id="license" tabindex="-1">License</h2>
<a class="header-anchor" href="#license"><span class="visually-hidden">Permalink to “License”</span> <span aria-hidden="true">#</span></a></div>
<p><code>node-gyp</code> is available under the MIT license. See the <a href="LICENSE">LICENSE<br>
file</a> for details.</p>
